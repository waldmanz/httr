<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Install or uninstall a callback function — get_callback • httr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Install or uninstall a callback function — get_callback" />
<meta property="og:description" content="Supported callback functions:
&amp;#8216;request&amp;#8217;This callback is called before an HTTP request
is performed, with the request object as an argument.
If the callback returns a value other than NULL, the HTTP
request is not performed at all, and the return value of the callback
is returned. This mechanism can be used to replay previously
recorded HTTP responses.
&amp;#8216;response&amp;#8217;This callback is called after an HTTP request
is performed. The callback is called with two arguments: the
request object and the response object of the HTTP
request. If this callback returns a value other than NULL,
then this value is returned by httr.


" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">httr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/quickstart.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/secrets.html">Managing secrets</a>
    </li>
    <li>
      <a href="../articles/api-packages.html">Best practices for API packages</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/12/httr-1-4-0/">Version 1.4.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/r-lib/httr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Install or uninstall a callback function</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-lib/httr/blob/master/R/callback.R'><code>R/callback.R</code></a></small>
    <div class="hidden name"><code>get_callback.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Supported callback functions:</p><dl>
<dt>&#8216;request&#8217;</dt><dd><p>This callback is called before an HTTP request
is performed, with the <code>request</code> object as an argument.
If the callback returns a value other than <code>NULL</code>, the HTTP
request is not performed at all, and the return value of the callback
is returned. This mechanism can be used to replay previously
recorded HTTP responses.</p></dd>
<dt>&#8216;response&#8217;</dt><dd><p>This callback is called after an HTTP request
is performed. The callback is called with two arguments: the
<code>request</code> object and the <code>response</code> object of the HTTP
request. If this callback returns a value other than <code>NULL</code>,
then this value is returned by <code>httr</code>.</p></dd>

</dl>

    </div>

    <pre class="usage"><span class='fu'>get_callback</span>(<span class='kw'>name</span>)

<span class='fu'>set_callback</span>(<span class='kw'>name</span>, new_callback = <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>name</th>
      <td><p>Character scalar, name of the callback to query or set.</p></td>
    </tr>
    <tr>
      <th>new_callback</th>
      <td><p>The callback function to install, a function object;
or <code>NULL</code> to remove the currently installed callback (if any).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>get_callback</code> returns the currently installed
callback, or <code>NULL</code> if none is installed.</p>
<p><code>set_callback</code> returns the previously installed callback,
or <code>NULL</code> if none was installed.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that it is not possible to install multiple callbacks of the same
type. The installed callback overwrites the previously intalled one.
To uninstall a callback function, set it to <code>NULL</code> with
<code>set_callback()</code>.</p>
<p>See the <code>httrmock</code> package for a proper example that uses
callbacks.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## Log all HTTP requests to the screeen</span>
<span class='kw'>req_logger</span> <span class='op'>&lt;-</span> <span class='fu'>function</span>(<span class='kw'>req</span>) {
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span>(<span class='st'>"HTTP request to"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sQuote.html'>sQuote</a></span>(<span class='kw'>req</span><span class='op'>$</span><span class='kw'>url</span>), <span class='st'>"\n"</span>)
}

<span class='kw'>old</span> <span class='op'>&lt;-</span> <span class='fu'>set_callback</span>(<span class='st'>"request"</span>, <span class='kw'>req_logger</span>)
<span class='kw'>g1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='GET.html'>GET</a></span>(<span class='st'>"https://httpbin.org"</span>)
<span class='kw'>g2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='GET.html'>GET</a></span>(<span class='st'>"https://httpbin.org/ip"</span>)
<span class='fu'>set_callback</span>(<span class='st'>"request"</span>, <span class='kw'>old</span>)

<span class='co'>## Log all HTTP requests and response status codes as well</span>
<span class='kw'>req_logger2</span> <span class='op'>&lt;-</span> <span class='fu'>function</span>(<span class='kw'>req</span>) {
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span>(<span class='st'>"HTTP request to"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sQuote.html'>sQuote</a></span>(<span class='kw'>req</span><span class='op'>$</span><span class='kw'>url</span>), <span class='st'>"... "</span>)
}
<span class='kw'>res_logger</span> <span class='op'>&lt;-</span> <span class='fu'>function</span>(<span class='kw'>req</span>, <span class='kw'>res</span>) {
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span>(<span class='kw'>res</span><span class='op'>$</span><span class='kw'>status_code</span>, <span class='st'>"\n"</span>)
}

<span class='kw'>old_req</span> <span class='op'>&lt;-</span> <span class='fu'>set_callback</span>(<span class='st'>"request"</span>, <span class='kw'>req_logger2</span>)
<span class='kw'>old_res</span> <span class='op'>&lt;-</span> <span class='fu'>set_callback</span>(<span class='st'>"response"</span>, <span class='kw'>res_logger</span>)
<span class='kw'>g3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='GET.html'>GET</a></span>(<span class='st'>"https://httpbin.org"</span>)
<span class='kw'>g4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='GET.html'>GET</a></span>(<span class='st'>"https://httpbin.org/ip"</span>)
<span class='fu'>set_callback</span>(<span class='st'>"request"</span>, <span class='kw'>old_req</span>)
<span class='fu'>set_callback</span>(<span class='st'>"response"</span>, <span class='kw'>old_res</span>)

<span class='co'>## Return a recorded response, without performing the HTTP request</span>
<span class='kw'>replay</span> <span class='op'>&lt;-</span> <span class='fu'>function</span>(<span class='kw'>req</span>) {
  <span class='co'>if</span> (<span class='kw'>req</span><span class='op'>$</span><span class='kw'>url</span> <span class='op'>==</span> <span class='st'>"https://httpbin.org"</span>) <span class='kw'>g3</span>
}
<span class='kw'>old_req</span> <span class='op'>&lt;-</span> <span class='fu'>set_callback</span>(<span class='st'>"request"</span>, <span class='kw'>replay</span>)
<span class='kw'>grec</span> <span class='op'>&lt;-</span> <span class='fu'><a href='GET.html'>GET</a></span>(<span class='st'>"https://httpbin.org"</span>)
<span class='kw'>grec</span><span class='op'>$</span><span class='kw'>date</span> <span class='op'>==</span> <span class='kw'>g3</span><span class='op'>$</span><span class='kw'>date</span>
<span class='fu'>set_callback</span>(<span class='st'>"request"</span>, <span class='kw'>old_req</span>)
}

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://hadley.nz'>Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


