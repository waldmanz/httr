<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Retry a request until it succeeds. — RETRY • httr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Retry a request until it succeeds. — RETRY" />
<meta property="og:description" content="Safely retry a request until it succeeds, as defined by the terminate_on
parameter, which by default means a response for which http_error()
is FALSE. Will also retry on error conditions raised by the underlying curl code,
but if the last retry still raises one, RETRY will raise it again with
stop().
It is designed to be kind to the server: after each failure
randomly waits up to twice as long. (Technically it uses exponential
backoff with jitter, using the approach outlined in
https://www.awsarchitectureblog.com/2015/03/backoff.html.)
If the server returns status code 429 and specifies a retry-after value, that
value will be used instead, unless it's smaller than pause_min." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">httr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/quickstart.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/secrets.html">Managing secrets</a>
    </li>
    <li>
      <a href="../articles/api-packages.html">Best practices for API packages</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/12/httr-1-4-0/">Version 1.4.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/r-lib/httr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Retry a request until it succeeds.</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-lib/httr/blob/master/R/retry.R'><code>R/retry.R</code></a></small>
    <div class="hidden name"><code>RETRY.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Safely retry a request until it succeeds, as defined by the <code>terminate_on</code>
parameter, which by default means a response for which <code><a href='http_error.html'>http_error()</a></code>
is <code>FALSE</code>. Will also retry on error conditions raised by the underlying curl code,
but if the last retry still raises one, <code>RETRY</code> will raise it again with
<code><a href='https://rdrr.io/r/base/stop.html'>stop()</a></code>.
It is designed to be kind to the server: after each failure
randomly waits up to twice as long. (Technically it uses exponential
backoff with jitter, using the approach outlined in
<a href='https://www.awsarchitectureblog.com/2015/03/backoff.html'>https://www.awsarchitectureblog.com/2015/03/backoff.html</a>.)
If the server returns status code 429 and specifies a <code>retry-after</code> value, that
value will be used instead, unless it's smaller than <code>pause_min</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>RETRY</span>(
  <span class='kw'>verb</span>,
  url = <span class='kw'>NULL</span>,
  config = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>...</span>,
  body = <span class='kw'>NULL</span>,
  encode = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"multipart"</span>, <span class='st'>"form"</span>, <span class='st'>"json"</span>, <span class='st'>"raw"</span>),
  times = <span class='fl'>3</span>,
  pause_base = <span class='fl'>1</span>,
  pause_cap = <span class='fl'>60</span>,
  pause_min = <span class='fl'>1</span>,
  handle = <span class='kw'>NULL</span>,
  quiet = <span class='fl'>FALSE</span>,
  terminate_on = <span class='kw'>NULL</span>,
  terminate_on_success = <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>verb</th>
      <td><p>Name of verb to use.</p></td>
    </tr>
    <tr>
      <th>url</th>
      <td><p>the url of the page to retrieve</p></td>
    </tr>
    <tr>
      <th>config</th>
      <td><p>Additional configuration settings such as http
authentication (<code><a href='authenticate.html'>authenticate()</a></code>), additional headers
(<code><a href='add_headers.html'>add_headers()</a></code>), cookies (<code><a href='set_cookies.html'>set_cookies()</a></code>) etc.
See <code><a href='config.html'>config()</a></code> for full details and list of helpers.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further named parameters, such as <code>query</code>, <code>path</code>, etc,
passed on to <code><a href='modify_url.html'>modify_url()</a></code>. Unnamed parameters will be combined
with <code><a href='config.html'>config()</a></code>.</p></td>
    </tr>
    <tr>
      <th>body</th>
      <td><p>One of the following:</p><ul>
<li><p><code>FALSE</code>: No body. This is typically not used with <code>POST</code>,
<code>PUT</code>, or <code>PATCH</code>, but can be useful if you need to send a
bodyless request (like <code>GET</code>) with <code><a href='VERB.html'>VERB()</a></code>.</p></li>
<li><p><code>NULL</code>: An empty body</p></li>
<li><p><code>""</code>: A length 0 body</p></li>
<li><p><code><a href='upload_file.html'>upload_file("path/")</a></code>: The contents of a file.  The mime
type will be guessed from the extension, or can be supplied explicitly
as the second argument to <code><a href='upload_file.html'>upload_file()</a></code></p></li>
<li><p>A character or raw vector: sent as is in body. Use
<code><a href='content_type.html'>content_type()</a></code> to tell the server what sort of data
you are sending.</p></li>
<li><p>A named list: See details for encode.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>encode</th>
      <td><p>If the body is a named list, how should it be encoded? Can be
one of form (application/x-www-form-urlencoded), multipart,
(multipart/form-data), or json (application/json).</p>
<p>For "multipart", list elements can be strings or objects created by
<code><a href='upload_file.html'>upload_file()</a></code>. For "form", elements are coerced to strings
and escaped, use <code><a href='https://rdrr.io/r/base/AsIs.html'>I()</a></code> to prevent double-escaping. For "json",
parameters are automatically "unboxed" (i.e. length 1 vectors are
converted to scalars). To preserve a length 1 vector as a vector,
wrap in <code><a href='https://rdrr.io/r/base/AsIs.html'>I()</a></code>. For "raw", either a character or raw vector. You'll
need to make sure to set the <code><a href='content_type.html'>content_type()</a></code> yourself.</p></td>
    </tr>
    <tr>
      <th>times</th>
      <td><p>Maximum number of requests to attempt.</p></td>
    </tr>
    <tr>
      <th>pause_base, pause_cap</th>
      <td><p>This method uses exponential back-off with
full jitter - this means that each request will randomly wait between 0
and <code>pause_base * 2 ^ attempt</code> seconds, up to a maximum of
<code>pause_cap</code> seconds.</p></td>
    </tr>
    <tr>
      <th>pause_min</th>
      <td><p>Minimum time to wait in the backoff; generally
only necessary if you need pauses less than one second (which may
not be kind to the server, use with caution!).</p></td>
    </tr>
    <tr>
      <th>handle</th>
      <td><p>The handle to use with this request. If not
supplied, will be retrieved and reused from the <code><a href='handle_pool.html'>handle_pool()</a></code>
based on the scheme, hostname and port of the url. By default <span class="pkg">httr</span>
requests to the same scheme/host/port combo. This substantially reduces
connection time, and ensures that cookies are maintained over multiple
requests to the same host. See <code><a href='handle_pool.html'>handle_pool()</a></code> for more
details.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>If <code>FALSE</code>, will print a message displaying how long
until the next request.</p></td>
    </tr>
    <tr>
      <th>terminate_on</th>
      <td><p>Optional vector of numeric HTTP status codes that if found
on the response will terminate the retry process. If <code>NULL</code>, will keep
retrying while <code><a href='http_error.html'>http_error()</a></code> is <code>TRUE</code> for the response.</p></td>
    </tr>
    <tr>
      <th>terminate_on_success</th>
      <td><p>If <code>TRUE</code>, the default, this will
automatically terminate when the request is successful, regardless of the
value of <code>terminate_on</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The last response. Note that if the request doesn't succeed after
<code>times</code> times this will be a failed request, i.e. you still need
to use <code><a href='stop_for_status.html'>stop_for_status()</a></code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Succeeds straight away</span>
<span class='fu'>RETRY</span>(<span class='st'>"GET"</span>, <span class='st'>"http://httpbin.org/status/200"</span>)
</div><div class='output co'>#&gt; Response [http://httpbin.org/status/200]
#&gt;   Date: 2020-09-10 15:40
#&gt;   Status: 200
#&gt;   Content-Type: text/html; charset=utf-8
#&gt; &lt;EMPTY BODY&gt;</div><div class='input'><span class='co'># Never succeeds</span>
<span class='fu'>RETRY</span>(<span class='st'>"GET"</span>, <span class='st'>"http://httpbin.org/status/500"</span>)
</div><div class='output co'>#&gt; <span class='message'>Request failed [500]. Retrying in 1 seconds...</span></div><div class='output co'>#&gt; <span class='message'>Request failed [500]. Retrying in 3.3 seconds...</span></div><div class='output co'>#&gt; Response [http://httpbin.org/status/500]
#&gt;   Date: 2020-09-10 15:40
#&gt;   Status: 500
#&gt;   Content-Type: text/html; charset=utf-8
#&gt; &lt;EMPTY BODY&gt;</div><div class='input'><span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Invalid hostname generates curl error condition and is retried but eventually</span>
<span class='co'># raises an error condition.</span>
<span class='fu'>RETRY</span>(<span class='st'>"GET"</span>, <span class='st'>"http://invalidhostname/"</span>)
}
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://hadley.nz'>Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


